---
title: 003 webpack编译流程
date: 2021-08-09
categories:
  - Webpack
tags:
  - Webpack
sidebar: "auto"
---


webpack的编译流程是一个串行的过程，从启动到结束会依次执行以下流程：
1. 初始化参数：从配置文件和Shell语句中读取并合并参数，得出最终的配置对象；
2. 开始编译：用上一步得到的参数初始化`Compiler`对象，加载所有配置的插件，执行对象的`run`方法开始执行编译；
3. 确定入口，根据配置中的`entry`找出所有的入口文件；
4. 编译模块：从入口模块出发，调用所有配置的`Loader`对模块进行编译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理；
5. 完成模块编译：在经过第4步使用`Loader`编译完所有的模块后，得到了每个模块被编译后的最终内容以及它们的依赖关系；
6. 输出资源：根据入口和模块的依赖关系，组装成一个个包含多个模块的`Chunk`，再把每个`Chunk`转换成一个单独的文件加入到输出列表，这一步是可以修改输出内容的最后机会；
7. 写入文件：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统。

在以上过程中，webpack会在特定的时间点广播出特定的事件（发布），插件可以去监听自己感兴趣的事件（订阅），等到事件被webpack触发后执行相应的逻辑，比如改变webpack的运行结果。

## module、chunk、bundle的区别
- module：各个源码文件，webpack中一切皆模块
- chunk：多模块合并成的，如entry、import()、splitChunk
- bundle：最终的输出文件