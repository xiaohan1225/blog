## 说说微前端架构整体演进过程和架构

项目痛点：
1. 项目代码量非常大，巨石项目
2. 不同技术栈维护成本高
3. 复用层

解决方案：
1. iframe
2. single-spa、qiankun，不同子项目子应用接入到统一平台
3. 微前端体系设计

## iframe 传统嵌入式方式

### 背景
早期的微前端架构是通过 `iframe` 来实现的，其本质上就是在一个页面内嵌入另一个网页，从而实现多个应用在同一个网页展示的效果。

## 使用场景
需要将外部应用嵌入到当前页面，比如在企业级系统中，可能需要将不同业务模块嵌入到同一个页面内，实现功能的“整合”。

## 优点
1. **独立性**：每个 `iframe` 都是一个独立的页面，有自己生命周期和上下文，可以独立运行，独立开发，独立部署，互不干扰。
2. **实现简单**：只需要通过 `iframe` 标签即可实现，无需复杂的配置和代码。

## 缺点
1. **性能问题**：`iframe` 性能开销大，多个页面嵌套时，加载很慢。
2. **难以通信和状态共享**：`iframe` 是独立的页面，互相隔离，导致应用间的通信和状态共享变得困难。
3. **跨域问题**：`iframe` 和父页面之间可能存在跨域问题，需要额外处理。

## single-spa

### 背景
随着单页面应用（SPA）的发展流行，微前端(`micro frontends`)的概念逐渐被提出，`single-spa` 是一个用于微前端架构的 JavaScript 库，它提供了一种统一的方式来管理和协调多个独立应用。

### 使用场景
`single-spa` 提供了一个加载和管理多个子应用的机制，这些子应用可以是不同的框架和库，比如 React、Vue、Angular 等。每个应用都可以独立开发、部署和更新，而不会影响到其他应用。

### 优点
1. **框架无关性**：支持多种前端框架，包括 React、Vue、Angular 等。
2. **高效加载**：通过路由和生命周期管理，在合适的时机加载和卸载子应用，提高性能。
3. **应用间隔离**: 子应用之间相互隔离，互不干扰。

### 缺点
1. **配置复杂**：需要配置路由和生命周期管理，对于新手来说可能比较复杂。
2. **性能问题**：由于各个应用是独立的，应用间的资源可能会重复加载，无法服用，增加内存和网络请求开销。

## qiankun

### 背景

`qiankun` 是一个基于 `single-spa` 的微前端框架，它提供了一种简单易用的方式来管理和协调多个子应用。`qiankun` 的目标是让开发者能够轻松地构建一个由多个独立应用组成的大型应用。

### 使用场景

`qiankun` 是一个很强大的微前端框架，能够轻松实现子应用的注册、加载、卸载等操作，以及应用间的通信和状态共享。

### 优点
- **强大的生命周期管理**：在应用的注册、加载、卸载等过程中可以通过生命周期定义逻辑。
- **动态加载子应用**：支持子应用的动态加载和按需加载，提高了性能。
- **内置的跨框架支持**：支持 React、Vue、Angular 等各种框架。

### 缺点
- **学习曲线**： 虽然它封装了很多便捷功能，但配置和使用仍然需要一定的学习成本。
- **应用间隔离问题**：子应用的隔离仍然需要一定的技术支持，比如避免 CSS 和 JavaScript 的冲突。




## 微前端方案设计
1. 微前端架构概述
- 微前端的定义与优势
- 微前端的技术栈与常见框架
- 微前端架构中的挑战

2. 项目背景与需求
- 业务系统概览：用户中心、营销中心、数据分析、订单管理、内容管理等。
- 项目需求分析：如何整合20多个独立的业务子应用
- 可扩展性、维护性与高效性需求

3. 选型：为什么选择 QianKun
- QianKun 概述
- QianKun 的优势：支持多种框架 （Vue、React、Angular等）、生命周期管理、跨应用通信等。

4. 微前端基座设计与架构
- 基座应用（Shell Application）设计与实现
- 子应用注册与加载
- 子应用隔离与沙箱机制

5. 业务系统拆分与子应用设计
- 如何将20多个业务系统拆分为独立的子应用
- 每个子应用的职责划分与独立性要求
- 子应用框架的选型与设计（Vue、React、Angular等）

6. 路由管理与跳转设计
- 主应用与子应用的路由管理策略
- 子应用路由与主路由的协同工作
- 使用 QianKun 的路由切换机制

7. 跨应用通信设计
- QianKun 的通信机制：共享状态与事件总线
- 应用间通信的策略：发布/订阅模式、全局状态管理
- 例子：如何在用户中心子应用与营销平台子应用之间共享数据

8. 性能优化与安全性考虑
- 如何确保子应用加载性能优化：懒加载、按需加载
- 性能瓶颈分析：如何处理多子应用并发加载、代码分割等
- 安全性：跨域安全、沙箱机制、子应用的隔离设计

9. 容器与子应用的部署策略
- 部署架构：基座应用与子应用的部署
- 子应用版本管理与升级机制
- 如何实现平滑过渡与无缝升级

10. 开发流程与工具链建设
- CI/CD 流程的设计：如何确保微前端架构下的自动化测试与构建
- 子应用独立开发与集成
- 自动化测试框架：如何编写跨子应用的测试用例

11. 监控与日志管理
- 微前端架构下的监控策略：如何监听所有子应用的健康状态
- 集中化日志系统与异常捕获
- 性能监控与分析工具的使用

12. 总结与展望
- 项目实施的关键点与挑战
- 微前端架构的长期维护与扩展
- 下一步的技术演化与优化方向
