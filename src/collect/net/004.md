---
title: 004 HTTP的响应状态码
date: 2021-07-27
categories:
  - 网络协议
tags:
  - HTTP
sidebar: "auto"
---

先看一个HTTP常见的状态行信息：
```js
HTTP/1.1 200 OK
```
其中HTTP是协议名，1.1是版本号，OK是原因短语，其中的200就是**状态码（Status Code）。** 

## 状态码
HTTP的状态码是一个十进制数字，表示服务器对请求的处理结果。

虽然RFC标准里规定的状态码是三位数，但如果从000一直按顺序开始编下去，灵活性和扩展性很差，所以状态码也被设计成有一定格式。状态码被分成了五类，第一位表示分类，0-99不用，所以状态码的可用范围就缩小为100~599了。

- 1xx：提示信息，表示目前是协议处理的中间状态，还需要后续的操作；
- 2xx：成功，报文已经收到并被正确处理；
- 3xx：重定向，资源位置发生变动，需要客户端重新发送请求；
- 4xx：客户端错误，请求报文有误，服务器无法处理；
- 5xx：服务器错误，服务器在处理请求时内部发生了错误。

在客户端和服务器端使用HTTP通信的时候，两方都应正确理解和应用这些状态码，服务器不要返回400、500这种含糊不清的状态码，而客户端应根据状态码调整请求报文，以达到预期结果。

目前RFC标准共有41个状态码，但状态码也跟请求方法一样，允许自行扩展。

## 1xx
1xx类状态码属于提示信息，是协议处理的中间状态，实际能用到的地方不多，见的比较多的是“ **101 Switching Protocols** ”，客户端使用Upgrade头字段，要求在HTTP协议的基础上改成其他的协议继续通信，比如WebSocket。如果服务器端也同意，可以回复状态码101，之后就不采用HTTP进行通信了。

## 2xx
2xx类状态码表示服务器收到并成功处理了客户端的请求。

**200 OK**：成功处理请求。

**204 No Content**：含义与200相同，但响应头后没有body数据。

**206 Partial Content**：表示“范围请求”，表示客户端要请求部分资源，是实现断点续传和分片上传功能的基础。状态码206通常是伴随着头字段“**Content-Range**”，表示响应报文里body数据的具体范围，供客户端确认。比如“Content-Range：bytes 0-99/2000”，意思是本次获取总计2000个字节里的前100个字节。

## 3xx
3xx类状态码的含义是重定向，表示服务器资源发生位置变化，客户端必须用新的URI重新发起请求获取资源。

**301 Moved Permanently**：永久重定向。通过是网站进行迁移，域名发生了变化，当用户访问源地址的URI的时候就可以使用301状态码。同时浏览器会对其进行缓存优化，下次进入会直接指向新地址。比如HTTP升级成了HTTPS。

**302 Moved Temporarily**：临时重定向。表示请求的资源还在，但需要暂时用另一个URI来代替。将服务器资源临时重定向到另一个地址，比如网站需要短时间的维护，此时需要让用户访问的时候转跳到另一个页面，等网站维护结束了，用户就可以正常访问，这时候就可以使用302状态码。

301和302都会在响应头里使用**Location**字段指明后续要跳转的URI。

**304 Not Modified**：用于If-Modified-Since等条件请求，表示资源未修改，用于缓存控制。它不具有通常的跳转含义，但可以理解成“重定向到已缓存的文件”，即缓存重定向。

## 4xx
4xx类状态码表示客户端错误，通常是请求报文有误。

**400 Bad Request**：400是一个很笼统的状态码，只是告诉客户端请求报文有错误，没说具体是什么错误，可能是url、请求头、请求体、请求方法等的错误。

**403 Forbidden**：服务器禁止访问资源，可能是当前角色权限不够，或者信息敏感、法律禁止等。

**404 Not Found**：请求的资源在服务器上找不到。

**405 Method Not Allowed**：不允许使用当前的请求方法请求此资源。

**406 Not Acceptable**：资源无法满足客户端请求的条件，比如请求中文但只有英文。

**408 Request Timeout**：请求超时，服务器等待了过长的时间。

**409 Conflict**：多个请求发生了冲突，可以理解为多线程并发时的竞态。

**413 Request Entity Too Large**：请求报文里的body太大。

**414 Request-URI Too Large**：请求行里的URI太大。

**429 Too Many Requests**：客户端发送了太多的请求，通常是由于服务器的限连策略。

**431 Request Header Fields Too Large**：请求头某个字段或总体太大。

## 5xx
5xx类状态码表示服务器端错误，就是服务器处理请求的时候出现了异常，是服务端的错误码。

**500 Internal Server Error**：跟400一样，是一个很笼统的状态码，告诉客户端服务器这边处理出错了，但具体什么错误我们不知道。这有好有坏，好处是保护服务器内部的详细信息，防止被黑客窥探攻击，坏处是不利于调试。

**501 Not Implemented**：表示客户端请求的功能还不支持。这个状态码比500稍“温和”一些：告诉你现在不支持，但具体什么时候支持就不好说了。

**502 Bad Gateway**：通常是服务器作为网关或者代理时返回的错误码，表示服务器自身工作正常，访问后端服务器时发生了错误，但具体的错误原因我们不得而知。

**503 Service Unavailable**：表示服务器当前很忙，暂时无法响应服务。503是一个“临时”的状态，可能过几秒后服务器就不那么忙了，可以继续提供服务，所以503的响应报文里通常还会有一个“**Retry-After**”字段，告诉客户端在多久以后可以再次尝试请求。