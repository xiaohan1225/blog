import{_ as s,o as l,c as a,ae as n}from"./chunks/framework.ByOFQPzk.js";const g=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"note/interview/project/低代码平台/低代码.md","filePath":"note/interview/project/低代码平台/低代码.md"}'),h={name:"note/interview/project/低代码平台/低代码.md"};function t(e,i,k,p,r,E){return l(),a("div",null,[...i[0]||(i[0]=[n(`<h2 id="操作历史" tabindex="-1">操作历史 <a class="header-anchor" href="#操作历史" aria-label="Permalink to &quot;操作历史&quot;">​</a></h2><h2 id="扁平式数据结构" tabindex="-1">扁平式数据结构 <a class="header-anchor" href="#扁平式数据结构" aria-label="Permalink to &quot;扁平式数据结构&quot;">​</a></h2><ul><li>优化操作历史的实现方式 <ul><li>全量 -&gt; 增量（JSON数据可能会达到2-3M，全量保存消化内存夸张）</li><li>操作历史合并（同一个节点 + 同一个属性）</li></ul></li><li>实时编辑属性、实时更新</li><li>协同编辑（参考在线文档），如何处理冲突，离线操作</li></ul><h2 id="组件清单" tabindex="-1">组件清单 <a class="header-anchor" href="#组件清单" aria-label="Permalink to &quot;组件清单&quot;">​</a></h2><ul><li>基础组件 <ul><li>单行文本</li><li>图片</li><li>按钮</li><li>滚动文字</li><li>多行文本</li><li>视频</li><li>锚点</li><li>模版</li><li>图标</li></ul></li><li>容器组件 <ul><li>多行容器</li><li>多列容器</li><li>轮播容器</li><li>弹框容器</li><li>固定容器</li><li>方形容器</li><li>粘性容器</li><li>宫格容器</li><li>标签容器</li></ul></li></ul><h2 id="操作历史-1" tabindex="-1">操作历史 <a class="header-anchor" href="#操作历史-1" aria-label="Permalink to &quot;操作历史&quot;">​</a></h2><h2 id="组件层级" tabindex="-1">组件层级 <a class="header-anchor" href="#组件层级" aria-label="Permalink to &quot;组件层级&quot;">​</a></h2><h2 id="样式操作" tabindex="-1">样式操作 <a class="header-anchor" href="#样式操作" aria-label="Permalink to &quot;样式操作&quot;">​</a></h2><ul><li>显示设置 <ul><li>元素类型（块级、行级）</li><li>背景设置</li><li>透明度</li><li>溢出</li></ul></li><li>对齐设置 <ul><li>主轴方向</li><li>弹性换行</li><li>主轴对齐方式</li><li>交叉轴对齐方式</li><li>弹性设置</li><li>弹性尺寸</li><li>弹性放大</li><li>弹性缩小</li><li>自身元素度对齐</li><li>主轴空间大对齐</li><li>浮动设置</li><li>首选纵横比</li></ul></li><li>文字设置 <ul><li>文字颜色</li><li>文字大小</li><li>文字对齐</li><li>最后对齐</li><li>文字行高</li><li>文字间距</li><li>换行设置</li><li>断行设置</li></ul></li><li>尺寸设置 <ul><li>宽度</li><li>最小宽度</li><li>最大宽度</li><li>高度</li><li>最小高度</li><li>最大高度</li></ul></li><li>外边距设置 <ul><li>外边距</li></ul></li><li>内边距设置 <ul><li>内边距</li></ul></li><li>边框设置 <ul><li>边框类型</li><li>边框颜色</li><li>边框大小</li><li>圆角设置</li></ul></li><li>定位设置 <ul><li>定位类型</li><li>层级优先级</li><li>元素定位</li><li>鼠标事件</li></ul></li><li>变换设置 <ul><li>变换设置（比如skew(45%)）</li><li>变换原点</li><li>位置平移</li><li>大小缩放</li><li>旋转变换</li></ul></li><li>滤镜 <ul><li>滤镜（比如brightness(0.5)）</li></ul></li></ul><h2 id="变量引擎" tabindex="-1">变量引擎 <a class="header-anchor" href="#变量引擎" aria-label="Permalink to &quot;变量引擎&quot;">​</a></h2><ul><li>变量的作用域</li><li>变量对的初始化类型</li><li>变量的数据类型</li><li>变量的泛型</li><li>模板变量</li><li>批量渲染</li></ul><p>绑定变量：</p><ul><li>自有变量 <ul><li>新建变量 <ul><li>自定义类型</li><li>接口查询 <ul><li>变量名称</li><li>变量标识</li><li>依赖变量</li><li>是否禁用阻塞渲染</li><li>接口模版</li><li>接口返回类型</li><li>当前实体数据类型</li><li>接口地址</li><li>请求方法</li><li>地址参数</li><li>请求参数</li><li>请求头</li><li>是否禁用分页参数</li><li>查询所有数据</li><li>页大小</li><li>起始页码</li><li>分页类型（比如拼接数据）</li></ul></li><li>规则变量（相当于一个函数，返回值一个计算后的值）</li><li>绑定变量 <ul><li>变量名称</li><li>变量标识</li><li>依赖变量</li><li>是否禁用阻塞渲染</li><li>绑定值（可以绑定某个变量实现变量别名的效果）</li></ul></li><li>模版变量（相当于渲染函数，输出值为渲染的内容，有一个模板组件，专门渲染模板变量） <ul><li>变量名称</li><li>变量标识</li><li>依赖变量</li><li>是否禁用阻塞渲染</li><li>模版类型 <ul><li>自定义（可支持图片）</li><li>绑定</li><li>引用</li></ul></li></ul></li></ul></li><li>变量列表</li></ul></li><li>继承变量</li></ul><h2 id="规则引擎" tabindex="-1">规则引擎 <a class="header-anchor" href="#规则引擎" aria-label="Permalink to &quot;规则引擎&quot;">​</a></h2><ul><li>规则引擎的作用</li><li>为什么使用规则引擎而不是流程引擎 <ul><li>流程节点改业务需求不好改</li><li>很乱，不清晰</li></ul></li><li>给定一个国庆期间下单活动，订单金额达到固定金额就赠送余额/积分</li></ul><p>需求变更：</p><ul><li>国庆期间下单限制取消</li><li>目前是赠送余额之后不再赠送积分，改成既赠送余额也赠送积分</li><li>更改逻辑，只有国庆最后两天才会赠送积分</li></ul><p>节点类型：</p><ul><li>并且执行-and</li><li>或者执行-any</li><li>并且并发-all</li><li>或者并发-race</li><li>数组循环-while</li><li>数组过滤-filter</li><li>变量赋值-set</li><li>接口调用-query</li><li>空值判断-hasValue</li><li>日期范围判断-dateRange</li><li>日期时间范围盘判断-datetimeRange</li><li>数字范围判断-numberRange</li><li>字符串相当判断-stringEqual</li><li>布尔值判断-boolean</li><li>数字运算-numberCrunching</li><li>调用规则（拷贝）-copyRules</li><li>调用规则（引用）-referRules</li></ul><h2 id="黑名单设置" tabindex="-1">黑名单设置 <a class="header-anchor" href="#黑名单设置" aria-label="Permalink to &quot;黑名单设置&quot;">​</a></h2><ul><li>通过 <code>blackListSet</code> 列出不可访问的全局对象（如 document、fetch）</li><li>在沙箱中访问这些对象时返回一个黑洞代理，避免报错</li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> blackListSet</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;top&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;self&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;parent&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;global&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;globalThis&#39;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;document&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;fetch&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;window&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;frames&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;XMLHttpRequest&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;MutationObserver&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre></div><h2 id="黑洞代理" tabindex="-1">黑洞代理 <a class="header-anchor" href="#黑洞代理" aria-label="Permalink to &quot;黑洞代理&quot;">​</a></h2><ul><li>任何对黑名单对象的访问，都会返回一个虚拟的“黑洞对象”</li><li>黑洞对象会吞掉任何访问或调用，而不会抛出异常</li></ul><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createBlackHole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Proxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createBlackHole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;toString&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Symbol.toPrimitive) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createBlackHole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="沙箱代理" tabindex="-1">沙箱代理 <a class="header-anchor" href="#沙箱代理" aria-label="Permalink to &quot;沙箱代理&quot;">​</a></h2><ul><li>使用 <code>Proxy</code> 创建沙箱对象，拦截用户代码对全局对象的访问。</li><li>对于黑名单对象，返回黑洞代理；对于正常对象，返回真实值或绑定后的函数。</li></ul><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createMockWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">base</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> win</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Proxy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Object.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assign</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({}, base), {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (globalVarNames.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(p)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> win;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (blackListSet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">has</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createBlackHole</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Reflect.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(window, p);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> win;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="沙箱运行代码" tabindex="-1">沙箱运行代码 <a class="header-anchor" href="#沙箱运行代码" aria-label="Permalink to &quot;沙箱运行代码&quot;">​</a></h2><ul><li>使用 <code>with</code> 语句注入沙箱对象，将用户代码与沙箱隔离。</li><li>通过严格模式（&#39;use strict&#39;）防止意外的全局变量泄漏。</li></ul><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> runUsersCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> finalCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`with(this) {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    return (function() {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &#39;use strict&#39;;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      return (\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">});</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      }).call(this);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  }\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(finalCode);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>`,31)])])}const c=s(h,[["render",t]]);export{g as __pageData,c as default};
