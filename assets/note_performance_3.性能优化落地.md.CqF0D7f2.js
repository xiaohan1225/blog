import{_ as l,c as e,o as p,ae as i}from"./chunks/framework.CvsoPZUE.js";const u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"note/performance/3.性能优化落地.md","filePath":"note/performance/3.性能优化落地.md"}'),t={name:"note/performance/3.性能优化落地.md"};function r(o,a,n,s,h,c){return p(),e("div",null,[...a[0]||(a[0]=[i('<h2 id="性能立项" tabindex="-1">性能立项 <a class="header-anchor" href="#性能立项" aria-label="Permalink to &quot;性能立项&quot;">​</a></h2><p>通过成立一个项目组，用项目化的运作方式来解决性能问题。</p><p>立项流程：</p><ul><li>团队成员确定</li><li>技术调研开展</li><li>项目目标制定</li><li>获取业务侧支持</li><li>项目名字选定</li><li>需求范围和优先级确定等过程</li></ul><p>为什么把需求范围和优先级确定放在后面？因为性能优化项目是探索性的项目需求，业务目标一般都有明确的项目目标和需求修改范围，而探索性项目需求，目标不确定，一般需要先选定项目团队，做完技术调研，才能确定出项目目标。</p><h3 id="项目目标制定" tabindex="-1">项目目标制定 <a class="header-anchor" href="#项目目标制定" aria-label="Permalink to &quot;项目目标制定&quot;">​</a></h3><p>性能项目的目标制定是一个正推与反推结合的过程。</p><p>正推：线索 -&gt; 本质或痛点问题 -&gt; 解决方案 -&gt; 目标</p><p>最终项目首屏时间可以减少 10%，对应 VPPV 可以提升 3%。</p><p>要达成一个“性感”的目标，至少需要提升 10% 的收入提升（平时波动都有 2%）。</p><p>VPPV：详情页的 UV 除以 列表页的 PV，这个指标和最终收入正相关，通俗一点来说就是，来店里的用户中，有多少最后买了东西。（省略了 VPPV 到广告收入的转化过程，用 VPPV 代替收益）。</p><p>怎么实现 10% 的收入提升呢，这时候就需要<strong>反推</strong>的过程。</p><p>反推：目标 -&gt; 解决方案 -&gt; 本质或痛点问题 -&gt; 线索</p><p>想要 10% 的收入提升（VPPV），至少需要 30% 的性能提升。</p><h4 id="获取业务侧支持" tabindex="-1">获取业务侧支持 <a class="header-anchor" href="#获取业务侧支持" aria-label="Permalink to &quot;获取业务侧支持&quot;">​</a></h4><p>前端团队一般都投入在各个业务方向，要做性能优化，就需要说明业务将部分前端资源投入到这个性能优化项目上来。</p><p>为了评估值不值得花时间在这上面，前端同学会和你提到项目收益。</p><p>技术方向收益：</p><ul><li>加载时间提升了多少</li><li>可以学到什么新技术 比如 react hooks，vue3等</li></ul><p>业务方向收益：</p><ul><li>流量增加多少</li><li>转化率提升多少</li><li>跳出率降低多少</li></ul><p>我们需要了解业务的关注点，从业务的角度去思考，去回答。</p><p>项目名：奥林匹亚项目，意思是更高、更快、更强。</p><p>最初：通过请求资源优化，将首屏时间提升 30%，后面为了让业务同事更直观理解项目收益，我们就把目标改成了“通过性能提升 30%，提升 VPPV 10%”。</p><h3 id="立项时机" tabindex="-1">立项时机 <a class="header-anchor" href="#立项时机" aria-label="Permalink to &quot;立项时机&quot;">​</a></h3><p>一定要做好<strong>技术可行性调研</strong>，性能优化是横向项目，会涉及多个业务，最好在试点两个业务后，再正式立项。</p><p>投入资源：前端 FE 10人，后端 RD 4 人，UI 设计 4 人，测试 2 人。 投入价值：20 人，2 个月，40 人月，约 XX 成本。 收获价值：访问量，VPPV 提升 10%，订单提升 8 %，约 XXX 万美金/季度。</p><p>一开始也想过从 0 到 1 完整做一个性能监控平台，但因为时间和人力关系，只能作罢。</p><p>直接选取了一个已经在用的一个开源展示平台，具体的数据指标定义和采集，需要我们自己来做。</p><h2 id="性能诊断优化" tabindex="-1">性能诊断优化 <a class="header-anchor" href="#性能诊断优化" aria-label="Permalink to &quot;性能诊断优化&quot;">​</a></h2><p>结合页面加载过程，进行性能问题诊断和优化。</p><p>瓶颈点：</p><ul><li>主要是通过本地缓存方案减少客户端请求数</li><li>同时让运维同时对静态资源配置了合理的过期时间，实现静态资源的强缓存方案。</li><li>对页面做了 DNS 的预解析处理。</li><li>对广告做懒加载。</li><li>为了确保页面解析不被中断，我们还对列表页的加载资源做了处理，也制定了 CSS 相关的规范，确保嵌套层次更少，让规则解析更简单。</li></ul><h3 id="弱网下的性能优化" tabindex="-1">弱网下的性能优化： <a class="header-anchor" href="#弱网下的性能优化" aria-label="Permalink to &quot;弱网下的性能优化：&quot;">​</a></h3><p>发现数据不及预期，后来在家里 2G 网络测试了一下，发现白屏了。</p><p>网络测速过程中，发现我们的弱网（2G、3G）用户超过 50%。</p><ul><li>尽可能合并请求（弱网下一个请求都需要2S），最后 26 个请求最后合并到了 11 个。</li><li>小图标采用 Base64 Encoding 的方式，内嵌于页面中，不用额外发网络请求来获取。</li><li>针对弱网（特别是移动网络），不自动加载图片，只显示本占位图。</li></ul><p>首屏时间从 2.5 S 提升到 1.5 s。</p><blockquote><p>注意：如果性能优化涉及多条业务线，最好是先把一条业务线打透，确保收入数据确实提升了，再推广到其它业务。</p></blockquote><p>优化的时候同时选了招聘和房产业务，结果因为一个问题，业务收入没有如预期的那样提升 10%，而是直接<strong>降低了 20%</strong>。</p><p>今天的数据是利好还是利空，如果是利空，还需要顶着业务同学压力，通过性能优化把收入数据优化提升上去。</p><h2 id="小结" tabindex="-1">小结 <a class="header-anchor" href="#小结" aria-label="Permalink to &quot;小结&quot;">​</a></h2><p>经过性能立项、性能采集和性能监控诊断，最后落实实施。</p><p>这个项目到底沉淀下来什么？是造轮子还是为业务打下了坚厚的基建基础？</p><p>性能监控预警平台肯定是一个大的沉淀，但是除此之外呢？怎么确保一个新人，在做性能优化时也能做到 80 分的水平？ 所以需要把优化过程的最佳实践沉淀下来。</p><p>未来如果有人 Review 这段代码，你希望学到什么？</p><p>希望在实际工作当中，你在性能优化之后记得把经验沉淀下来，可以写成文档或代码。</p><p>问题：优化前后如何对比数据，如果我们只是对比上线前后的数据，怎么排除这段时间业务升级带来的影响？</p>',48)])])}const _=l(t,[["render",r]]);export{u as __pageData,_ as default};
